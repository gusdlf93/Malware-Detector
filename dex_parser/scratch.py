import os
import numpy as np

root_path = r'D:\android\Data\data_sec_20_txt\conv1d_4_grad'
malware_class = os.listdir(r'F:\android\dataset_20')
dex_path = r'F:\android\parse_dex\workspace'

folder_list = os.listdir(root_path)
for malware in malware_class:
    folder_path = os.path.join(root_path, malware)
    npy_list = os.listdir(folder_path)
    for np_file in npy_list:
        mal_np = np.load(os.path.join(root_path, malware, np_file), allow_pickle=True)
        dex_file = open(os.path.join(dex_path, malware, np_file).replace('.npy', '.dex'), 'rb')
        dex = dex_file.read()
        #byte_dex = [dex[i:i+1] for i in range(len(dex))]
        #.to_bytes(1, byteorder="little")
        dex_bytes = []
        for i in mal_np:
            start = i[0] - 5
            end = i[-1]+5
            hex_list = []
            for j in range(start-5, end+5):
                hex_list.append(hex(dex[j]))
            dex_bytes.append(hex_list)